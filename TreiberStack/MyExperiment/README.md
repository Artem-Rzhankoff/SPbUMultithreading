# Эксперимент

### Окружение
- `Windows 10 Home`
- Процессор: `AMD Ryzen 5 5500U`
- Общее количество ядер = 6 с масимальным числом потоков = 12
- Объем оперативной памяти: `16Гб`
- `.NET 8`

### Улучшенный backoff стек с элиминацией
_Основано на [данной статье](https://www.cs.vu.nl/~wanf/theses/woudenberg-bscthesis.pdf)_

Главное улучшение приходится на lock-free exchanger. В данной реализации (в отличие от основной) мы используем знание
о том какой вид операции происходит для избежаний коллизий _(`WAITING` разделяется на два состояния: `WAITINGPOPPER`, `WAITINGPUSHER`)_. 
В последствии при определенном статусе `WAITING` нужно будет также проверить, что в ячейке лежит противоположный.



### Замеры

Будем сравнивать производительность lock-free стека с улучшенным backoff стеком с элиминацией.
- Единица измерения - количество мегаопераций в секунду.
- Проведем два эсперимента - с выбором случайных операций и последовательности `push/pop`
- Количество операций - `100 тыс` для RandomExperiment и `100*2 тыс` для `push/pop`
- Количество воспроизведений - `20`, результатом будем считать их среднее
- Замеры проводились для $thread \in [1; 2]$

Детали эксперимента:
- Для `RandomExperiment` мы заранее добавляем в стек `100тыс` элементов
- Замеряется только время работы всех операций, потоки выделяются заранее

### Результаты и их анализ

Результаты представлены в таблицах [здесь](./performanceResults.png) и [здесь](performanceResultsRandom.png)

Можно заметить несколько важных особенностей:
- Самая высокая скорость достигается на 1 потоке, далее идет резкий спад _(при переходе на 2 потока)_
  и потом гораздо более менее резкий спад;
- Оптимизация с элиминаций показала худшую производительность лишь при 1 потоке. Далее был резкий скачок прироста
 и его последующее постепенное уменьшение. Хотя даже для 12 потоков прирост составил `300%`;
- Последовательность операций не оказала существенного влияния на прирост производительности. По мнению автора, 
  это связано с размером elimination array;
- Также результаты эспериментов сопоставимы с результатами из приведенной выше статьи;
